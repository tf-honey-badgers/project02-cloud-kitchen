<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="org.badgers.rest.customer.kitchen.persistence.KitchenMapper">

	<select id="kitchenbranchList"
		resultType="org.badgers.rest.model.KitchenBranchVO">
		select * from kitchen_branch
	</select>

	<select id="bizList" resultType="org.badgers.rest.model.BizVO">
		select * from biz
	</select>
	
	<resultMap id="MenuOptionEx" type="org.badgers.rest.model.MenuOptionVOExtend">
		<result property="moCode" column="moCode"/>
		<result property="moName" column="moName"/>
		<result property="moAddPrice" column="moAddPrice"/>
		<result property="moOptClNo" column="moOptClNo"/>
	</resultMap>
	
	 <resultMap id="MenuOptionClVoEx" type="org.badgers.rest.model.MenuOptionClVOExtend">
		<result property="mocNo" column="mocNo"/>
		<result property="mocName" column="mocName"/>
		<result property="mocMenuOptType" column="mocMenuOptType"/>
		<result property="mocMenuCode" column="mocMenuCode"/>
		<collection property="menuOptEx" javaType="java.util.ArrayList" resultMap="MenuOptionEx"/> 
	</resultMap>
	
 	<resultMap id="MenuVoEx" type="org.badgers.rest.model.MenuVOExtend">
		<result property="mCode" column="mCode"/>
		<result property="mName" column="mName"/>
		<result property="mBasicPrice" column="mBasicPrice"/>
		<result property="mPhoto" column="mPhoto"/>
		<result property="menuCatCode" column="menuCatCode"/>
		<collection property="menuOptCl" javaType="java.util.ArrayList" resultMap="MenuOptionClVoEx"/> 
	</resultMap>

	<resultMap id="MenuCatVoEx" type="org.badgers.rest.model.MenuCatVOExtend">
		<result property="mcNo" column="mcNo"/>
		<result property="mcName" column="mcName"/>
		<result property="mcBizId" column="mcBizId"/>
	 	<collection property="mcMenuvo" javaType="java.util.ArrayList" resultMap="MenuVoEx"/> 
	</resultMap>
	
 	<resultMap id="bizvo" type="org.badgers.rest.model.BizVOExtend">
		<result property="bizId" column="bizId" />
		<result property="bizInfo" column="bizInfo" />
		<result property="bizName" column="bizName" />
		<result property="bizLikeCnt" column="bizLikeCnt" />
		<result property="bizMinAmt" column="bizMinAmt" />
		<result property="bizCatId" column="bizCatId" />
		<result property="bizKitchenId" column="bizKitchenId" />
		<result property="bizLiveStrm" column="bizLiveStrm" />
		<result property="bizIdx" column="bizIdx" />
		<collection property="bizMenucatvo" javaType="java.util.ArrayList" resultMap="MenuCatVoEx"/>
	</resultMap>

	<select id="bizInfo" resultMap="bizvo">
		select 
			
			b.biz_id bizId,
			b.info bizInfo,
			b.name bizName,
			b.like_cnt bizLikeCnt,
			b.min_amt bizMinAmt,
			b.biz_cat_id bizCatId,
			b.kitchen_id bizKitchenId,
			b.biz_live_strm bizLiveStrm,
			b.idx bizIdx,
			
			mc.idx mcNo,
			mc.name mcName,
			mc.biz_id mcBizId,
			
			m.idx mCode,
			m.name mName,
			m.basic_price mBasicPrice,
			m.photo mPhoto,
			m.category_id menuCatCode,

			moc.idx mocNo,
			moc.name mocName,
			moc.menu_opt_type mocMenuOptType,
			moc.menu_id mocMenuCode,

			mo.idx moCode,
			mo.name moName,
			mo.add_price moAddPrice,
			mo.opt_cl_id moOptClNo
		
		from biz b left outer JOIN menu_category mc
		on b.biz_id = mc.biz_id
		left outer join menu m
		on mc.idx = m.category_id
		left outer join menu_option_cl moc
		on m.idx = moc.menu_id
		left outer join menu_option mo
		on moc.idx = mo.opt_cl_id
		
		where b.biz_id=#{bizId};
	</select>
	
	
	
	<select id="getCategorization" resultType="org.badgers.rest.model.CommonCodeVOExtend">
		select * from common_code where id like 'STR%'
	</select>
	
	<select id="getCatKitchen" resultType="org.badgers.rest.model.KitchenSelectCatVOExtend">
		select 
			b.biz_id bizId,
			b.info bizInfo,
			b.name bizName,
			b.like_cnt bizLikeCnt,
			b.biz_cat_id bizCatId,
			b.idx bizIdx,
			
			c.id comId,
			c.name comName,
			c.description comDisc,
			c.idx comIdx 
			
		from biz b,common_code c
		where c.id = b.biz_cat_id and c.name=#{menuCat}
	</select>
</mapper>